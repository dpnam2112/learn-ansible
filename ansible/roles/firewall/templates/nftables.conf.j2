# {{ ansible_managed }}
#!/usr/sbin/nft -f

flush ruleset

{% if firewall_enable_baseline %}
table inet baseline {
  chain input {
    type filter hook input priority -100; policy accept;
    iif "lo" accept
    ct state established,related accept
    ct state invalid drop
  }
  chain output {
    type filter hook output priority -100; policy accept;
    ct state established,related accept
  }
  chain forward {
    type filter hook forward priority -100; policy drop;
  }
}
{% endif %}

# Managed includes
{% for g in firewall_include_globs %}
include "{{ g }}";
{% endfor %}

